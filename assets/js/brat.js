// Generated by CoffeeScript 1.4.0
var bratLocation, collData, getDocData, getDocMentionData, webFontURLs;

bratLocation = '/assets/brat';

head.js(bratLocation + '/client/lib/jquery.min.js', bratLocation + '/client/lib/jquery.svg.min.js', bratLocation + '/client/lib/jquery.svgdom.min.js', bratLocation + '/client/src/configuration.js', bratLocation + '/client/src/util.js', bratLocation + '/client/src/annotation_log.js', bratLocation + '/client/lib/webfont.js', bratLocation + '/client/src/dispatcher.js', bratLocation + '/client/src/url_monitor.js', bratLocation + '/client/src/visualizer.js');

webFontURLs = [bratLocation + '/static/fonts/Astloch-Bold.ttf', bratLocation + '/static/fonts/PT_Sans-Caption-Web-Regular.ttf', bratLocation + '/static/fonts/Liberation_Sans-Regular.ttf'];

collData = {
  entity_types: [
    {
      type: 'Mention',
      labels: ['Ment', 'M'],
      bgColor: "#7fa2ff",
      borderColor: 'darken'
    }
  ]
};

getDocData = function(doc) {
  return {
    text: doc.text.replace(/(\r\n|\n|\r)/gm, " "),
    entities: _.zip(_.map(_.range(doc.tstarts.length), function(elt) {
      return "T" + elt;
    }), doc.tpos, _.map(_.zip(doc.tstarts, _.map(_.zip(doc.tstarts, doc.tlengths), function(elt) {
      return elt[0] + elt[1];
    })), function(elt) {
      return [elt];
    }))
  };
};

getDocMentionData = function(doc, mentions) {
  var mends_char, mends_tok, mlengths_tok, mstarts_char, mstarts_tok;
  mstarts_tok = _.map(mentions, function(elt) {
    return elt.start;
  });
  mlengths_tok = _.map(mentions, function(elt) {
    return elt.length;
  });
  mends_tok = _.map(_.zip(mstarts_tok, mlengths_tok), function(elt) {
    return elt[0] + elt[1] - 1;
  });
  mstarts_char = _.map(mstarts_tok, function(elt) {
    return doc.tstarts[elt];
  });
  mends_char = _.map(mends_tok, function(elt) {
    return doc.tstarts[elt] + doc.tlengths[elt];
  });
  return {
    text: doc.text.replace(/(\r\n|\n|\r)/gm, " "),
    entities: _.zip(_.map(_.range(mentions.length), function(elt) {
      return "T" + elt;
    }), _.map(mentions, function(elt) {
      return "M-" + elt.docEntity;
    }), _.map(_.zip(mstarts_char, mends_char), function(elt) {
      return [elt];
    }))
  };
};
